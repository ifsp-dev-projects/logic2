<!doctype html>
<html lang="pt-BR" class="theme-dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Coda</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Padauk:wght@400;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body id="{{ body_id }}">
  <!-- ======= NAVBAR ======= -->
  <header class="topbar">
    <nav class="nav">
      <a class="brand" href="/" aria-label="SomVerso — Início">
        <span class="logo" aria-hidden="true"></span>
        <span>CODA</span>
      </a>

      <!-- Barra de pesquisa -->
      <form class="search" role="search">
        <input type="search" placeholder="Buscar artistas, músicas, festivais…" aria-label="Buscar" />
        <svg class="icon" width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </form>

      <!-- Área direita: menu perto do login + botão de login único -->
      <div class="right">
         <ul class="menu" aria-label="Navegação principal">
            {% for item in menu %}
                <li>
                    <a href="{{ item.rota }}">{{ item.nome }} </a>
                    <div class="dropdown" role="menu" aria-label="Submenu ${item.nome}">
                    <a href="#">{{item.a}}</a>
                    <a href="#">{{item.b}}</a>
                    <a href="#">{{item.c}}</a>
                    <a href="#">{{item.d}}</a>
                    </div>
                </li>
            {% endfor %}    
        </ul>
        <a href="/mudarLogin" style="text-decoration: none;">
          <button type="button" class="login-btn" aria-label="Entrar">Entrar</button>  
        </a>
        <button class="tema-btn" type="button" aria-label="Tema">Tema</button>
      </div>
    </nav>
  </header>
 
  {% if pagina == 'index' %}
  <section class="hero" aria-label="Em alta">
    <h1>Aplicação SSR</h1>
    <div class="hero-strip" >
        {% for banner in banners %}
        <a class="news-card" href="{{ banner.url }}" target="_blank">
            <span class="badge">{{ banner.categoria }}</span>
            <img class="thumb" src="{{ banner.img }}" alt="{{ banner.alt }}"/>
            <div class="title">{{ banner.titulo }}</div>
        </a>
        {% endfor %}
    </div>
  </section>

  <section class="section" aria-labelledby="top-artistas">
    <div class="section-head">
        <h2 id="top-artistas">Top Artistas</h2>
        <div class="sub">Em alta nesta semana</div>
    </div>

    <div class="artists-wrap">
                <button class="arrow prev" aria-label="Anterior" data-action="prev">&#10094;</button>
            <div class="artists-viewport">
                <div class="artists-track" id="artistsTrack">
                {% for artista in artistas %}
                    <a class="artist" href="#" aria-label="{{ artista.nome }}">
                        <img src="{{ artista.foto }}" alt="{{ artista.nome }}" />
                        <span class="overlay">{{ artista.nome }}</span>
                    </a>
                {% endfor %}
                </div>
            </div>
            <button class="arrow next" aria-label="Próximo" data-action="next">&#10095;</button>
    </div>
  </section>

  <section class="section" aria-label="Destaques">
    <div class="grid">
        {% for destaque in destaques %}
        <article class="card">
            <img class="cover" src="{{ destaque.img }}" alt="{{ destaque.alt }}"/>
            <div class="body">
                <span class="chip">{{ destaque.categoria }}</span>
                <h3 class="title-sm">{{ destaque.titulo }}</h3>
            </div>
        </article>
        {% endfor %}
    </div>
  </section>
  {% elif pagina == 'noticias' %}
  <section class="section" aria-label="Destaques">
    <div class="grid">
    {% for noticia in noticias %}
    <article class="card">
        <img class="cover" src="{{ noticia.img }}" alt="" />
        <div class="body">
            <span class="chip">Notícias</span>
            <h3 class="title-sm">{{ noticia.titulo }}</h3>
        </div>
    </article>  
    {% endfor %}
    </div>
  </section>
  {% elif pagina == 'eventos' %}
  <section class="section" aria-label="Destaques">
    <div class="grid">
    {% for evento in eventos %}
    <article class="card">
        <img class="cover" src="{{ evento.img }}" alt="" />
        <div class="body">
            <span class="chip chip--pink">Eventos</span>
            <h3 class="title-sm">{{ evento.titulo }}</h3>
        </div>
    </article>
    {% endfor %}
    </div>
  </section>
  {% else %}
  <section class="section" aria-label="Destaques">
    <div class="grid">
        {% for premio in premiacoes %}
        <article class="card">
            <img class="cover" src="{{ premio.img }}" alt="" />
            <div class="body">
                <span class="chip">Premiações</span>
                <h3 class="title-sm">{{ premio.titulo }}</h3>
            </div>
        </article>
        {% endfor %}
    </div>
  </section>
  {% endif %}
  <!-- ======= FOOTER ======= -->
  <footer>
    <div class="foot">
      <div>
        <strong>Coda</strong> — Portal de música moderno. 
      </div>
      <div class="social" aria-label="Redes sociais">
        <span class="dot" title="Instagram"></span>
        <span class="dot" title="X/Twitter"></span>
        <span class="dot" title="YouTube"></span>
      </div>
    </div>
  </footer>

  <script>
    (function(){
      const track = document.getElementById('artistsTrack');
      let page = 0; 

      function move(dir){
        const viewport = track.parentElement.getBoundingClientRect().width;
      
        const first = track.querySelector('.artist');
        if(!first) return;
        const style = getComputedStyle(track);
        const gap = parseFloat(style.gap || '0');
        const itemWidth = first.getBoundingClientRect().width;
        const perView = Math.max(1, Math.round((viewport + gap) / (itemWidth + gap)));

        const total = track.children.length;
        const maxPage = Math.ceil(total / perView) - 1;
        page = Math.min(maxPage, Math.max(0, page + dir));
        const offset = -(viewport + gap) * page;
        track.style.transform = `translateX(${offset}px)`;
      }

      document.querySelector('[data-action="prev"]').addEventListener('click', ()=> move(-1));
      document.querySelector('[data-action="next"]').addEventListener('click', ()=> move(1));
      window.addEventListener('resize', ()=> { track.style.transform = 'translateX(0)'; page = 0; });
    })();
  </script>
</body>
</html>